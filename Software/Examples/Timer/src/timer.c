/*******************************************************************************
 *
 * Project  :	PCAN-GPS
 * Module   :
 * Filename :	timer.c
 * System   :
 * Compiler :
 * Switches :
 * Rights   : 	(c) PEAK-System Technik GmbH
 *            	www.peak-system.com
 *
 *******************************************************************************
 * Implementation description
 *
 *
 *
 *******************************************************************************
 * History: (newer entries first!)
 *------------------------------------------------------------------------------
 * Date / Name      Vers.   changes made
 *------------------------------------------------------------------------------ 
 * 2015 Nov  05/StM	0.0.2	fixed wrong prescaler value
 * 2014 June xx/StM	0.0.1	Initial Version
 ******************************************************************************/
/*******************************************************************************
 include files
 ******************************************************************************/
//
// System header files
//

//
// Library header files
//
#include <system_LPC407x_8x_177x_8x.h>
#include <lpc407x_8x_177x_8x.h>
//
// Source code header files
//
#include "typedefs.h"
#include "hardware.h"
#include "timer.h"


/*******************************************************************************
 global definitions
 ******************************************************************************/


/*******************************************************************************
 local definitions
 ******************************************************************************/
extern void Timer_1000usec(void);


/*******************************************************************************
 local function prototypes
 ******************************************************************************/


/*******************************************************************************
 global functions
 ******************************************************************************/


//------------------------------------------------------------------------------
//! void Init_Timer0 (void)
//------------------------------------------------------------------------------
//! @brief	initializes timer 0 as system timer
//------------------------------------------------------------------------------
void Init_Timer0 (void){
	NVIC_DisableIRQ(TIMER0_IRQn);

	LPC_SC->PCONP |= 1 << 1; 	// Power on for Timer0

	LPC_TIM0->TCR = 2;			// Timer0 stop

	LPC_TIM0->PR = 119; 		// Divide PCLK=120[MHz] by 120 = 1[MHz]

	LPC_TIM0->CCR = 0;

	LPC_TIM0->MCR = 0;

	LPC_TIM0->IR = 0xFFFFFFFF;	// Clear all interrupts
	LPC_TIM0->TCR = 1;			// Timer0 start

	return;
}

